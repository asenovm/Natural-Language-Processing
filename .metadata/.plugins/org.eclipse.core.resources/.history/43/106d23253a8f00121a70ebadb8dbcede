package edu.coursera.nlp.homework.one;

import java.io.File;
import java.io.IOException;
import java.util.Scanner;
import java.util.TreeMap;

public class CountReader {

	/**
	 * {@value}
	 */
	private static final String SEPARATOR_WORD = " ";

	/**
	 * {@value}
	 */
	private static final String TAG_WORD = "WORDTAG";

	private final TreeMap<String, Integer> wordCounts;

	public CountReader() {
		wordCounts = new TreeMap<String, Integer>();
	}

	public void read(final String filePath) throws IOException {
		final Scanner scanner = new Scanner(new File(filePath));
		while (scanner.hasNext()) {
			final String currentLine = scanner.next();
			if (!currentLine.contains(TAG_WORD)) {
				break;
			}

			final String[] line = currentLine.split(SEPARATOR_WORD);

			final int wordCount = Integer.parseInt(line[0]);
			final String word = line[line.length - 1];
			if (wordCounts.containsKey(word)) {
				wordCounts.put(word, wordCounts.get(word) + wordCount);
			} else {
				wordCounts.put(word, wordCount);
			}
		}
	}

}
