package edu.coursera.nlp.homework.one;

import java.io.File;
import java.io.IOException;
import java.util.HashMap;
import java.util.Map;
import java.util.Scanner;

public class CountReader {

	/**
	 * {@value}
	 */
	private static final String SEPARATOR_WORD = " ";

	/**
	 * {@value}
	 */
	private static final String TAG_WORD = "WORDTAG";

	private final Map<String, Integer> wordCounts;

	public CountReader() {
		wordCounts = new HashMap<String, Integer>();
	}

	public void read(final String filePath) throws IOException {
		final Scanner scanner = new Scanner(new File(filePath));

		while (scanner.hasNext()) {
			final String currentLine = scanner.next();
			if (currentLine.contains(TAG_WORD)) {
				countLine(currentLine);
			}
		}
	}

	private void countLine(final String line) {
		final String[] tokens = line.split(SEPARATOR_WORD);
		final String word = tokens[tokens.length - 1];
		final int occurrences = Integer.parseInt(tokens[0]);

		if (wordCounts.containsKey(word)) {
			wordCounts.put(word, wordCounts.get(word) + occurrences);
		} else {
			wordCounts.put(word, occurrences);
		}
	}

}
